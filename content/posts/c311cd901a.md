---
title: "词元计数器的前端设计"
date: "2025-03-22T07:44:25+08:00"
tags: ["前端开发", "随笔"]
draft: false
noindex: false
enableKaTeX: false
cover:
    image: "/img/c311cd901a.md/cover.jpg"
    alt: "雪中的初音未来"
    hidden: false
---

之前搭建[桶装幺蛾子](https://hi.bug-barrel.top/)的时候，词元细心挑选了速度和功能比较均衡的 [Hugo](https://gohugo.io) 作为框架。事实证明，Hugo 确实很快，在 Cloudflare Pages 上构建时间是 Hexo 的*十分之一*。

> 🤯 前情提要：因为一个很愚蠢的错误，词元丢失了所有 MFA 凭据，无法修改旧博客了。

但是，在用户体验上，词元犯了懒，直接把 Hugo 上比较有名的 PaperMod 主题拿来用。更有甚者，对于想自定义的地方，词元直接用“补丁”的方法去修改。举个例子，要加 Giscus 评论功能，就把 PaperMod 的转发部件*清空*，然后把 Giscus 部件粘贴进去……

总之，当时词元完美地展现了 B 端产品后端开发者的设计水平，一大堆造轮子和补丁的代码混杂。现在构建新的博客，词元下定决心，~~要展现一个 B 端、P 端全栈开发者的全能性~~要仔细设计词元计数器的主题 🐶

> 🔔 注意：本文不是搭建博客的教程。

## 🏗️ 第一次尝试

词元很喜欢干净的代码，对于冗余几乎有一种强迫症般的厌恶。因此，在研究 Hugo 主题文档半天之后，词元设计了“计数器”主题，仓库在 [tokenicrat/hugo-theme-counter](https://github.com/tokenicrat/hugo-theme-counter)。

![“计数器”主题截图](/img/c311cd901a.md/1.png)

主观上，词元还是很喜欢这个主题的：CSS 很少，没有 JS，完善的深色模式支持，简洁的排版。它的功能也很最小化，根据词元的需求，需要的外部库只有 Google Fonts 和可选的 KaTeX。

> ❓ 关于为什么最小化的设计却使用了 Google Fonts，下面会说到。

但是，计数器的问题也很明显：由于词元始终没有研究出来 Hugo 的标签、分类体系，这个主题*完全*没有标签的支持。而且，有些复杂的 CSS 样式，词元写不出来；基础的样式，很简洁，但是总感觉差点意思。

于是，词元放弃了自创主题的企图，又回到了 PaperMod——作为基础，进行自定义。

## 👷 CratMod

[PaperMod](https://adityatelange.github.io/hugo-PaperMod/) 是一个很不错的的主题，默认样式已经很简洁耐看了。

但是词元肯定是不满足于此的，进行了一些~~魔改~~修改。

### 🗑️ 删！删！删！

基于和计数器主题一样的理念，词元第一件事就是将所有不需要的功能删除。

整理一下，主要清除了这些功能的 `partial`、CSS 和 JS：

- OpenGraph、自带的评论功能（没有词元需要的 Giscus 支持 😑）。
- Profile 模式。
- 一些没啥用的按钮（语言选择、亮暗主题切换、分享、文章切换等等）。
- 用不上的 shortcode。

删除完成之后，主题文件夹的大小减少了一大半，目录结构也更清晰了。

### 🧨 新功能

词元最需要的功能有两个，一个是 LaTeX 支持，另一个是 Giscus 作为评论组件。

对于 LaTeX 支持，这很简单，有现成的 [KaTeX](https://katex.org/) 可以使用，直接在 `head.html` 添加引用就行了。为了避免在不需要的地方引入，词元引入了 `front-matter` 设置，可以按文章选择是否启用。

KaTeX 提供了相当完备的[文档](https://katex.org/docs/browser)，很容易学会；唯一一个比较坑的地方，就是监听 `$$` 符号来渲染公式不是默认的，需要[手动添加](https://katex.org/docs/autorender.html)。

至于 Giscus，直接一步一步[引导](https://giscus.app/)你添加，在 `footer.html` 找个合适的位置写进去就好，记得添加 `hugo.yaml` 开关。

### 🖼️ 字体设计

原本 PaperMod 是为英语设计的，因此直接使用了 Sans 字体，并且是所谓 web-safe 的字体栈。但是，词元写的是中文，而对于中文，这些 web-safe 也不是特别 safe。

就拿词元的 Linux 平台来说吧，中文字体可以是 Noto Sans CJK、Adobe Source Han Sans CN、WQY Zenhei 甚至 GNU Unifont……这些在大部分网站的字体栈中都是不存在的，然后就会回退到 `sans-serif`。

因此，所谓 web-safe 主要是针对 Windows 和 macOS 而言的。为了达到真正的“全平台”，使用外部字体是很有必要的，而通常“外部字体”特指 Google Fonts。这当然会拖慢页面加载，尤其是在国内；但是，感谢赛博菩萨 Cloudflare，不需要特殊设置，Cloudflare 会自动使用它的字体 CDN 代替 Google Fonts，这样加载速度也说得过去。

词元使用了三种字体：Noto Sans CJK、Noto Serif CJK 和 Noto Mono。前两种很好说，视觉抓力比较强的宋体加粗用作标题，规整、易于阅读的等线用作正文。有意思的是这个 Noto Mono，不仅仅用作代码，还用于所有英语和符号。

这是因为，中文有个特点，就是字宽、字高都是固定的，而且可以在任何地方换行，都不会影响排版舒适；英文不具有这个特点。当中英文混排的时候，就会导致英文在中文里看起来特别不规整，因此词元选择“规整”的英文——等宽字体，来平衡排版上的不均衡。

从主观的观感上，词元觉得这个设计相当不错。

### 🫟 杂项

还有一些细节要提一提：

- 首页标题居中：词元不喜欢那种全屏的 profile；但是，像 PaperMod 这种把标题当作普通文本左对齐的做法，还是不大好看的。因此词元做了折中，调大首页标题并居中，增加了四周的空间并提高亮度。
- 图标：浏览器标签页图标，词元就选择了头像；但是标题栏使用的图标（🔏）是有特殊含义的，您应该很容易就能看出来词元想表达什么。
- Emoji：词元非常喜欢用大量 emoji，这样可以让文本更丰富多彩，降低大量文本产生的枯燥感。
- 初音未来：咳咳，词元下了很大的决心，不给首页添加初音未来的背景 😁 这样可以维持封面色彩与单调背景的平衡。
- 改名：就叫 CratMod 吧（Tokeni**crat** 魔改的 Paper**Mod**）。

主题就在博客仓库的 `themes` 目录里，您可以到 [tokenicrat/token-counter](https://github.com/tokenicrat/token-counter) 去看看，也欢迎您自己下载使用，the Unlicense 授权哦。

您要啥？预览？预览？！您正在看的这篇文章，但凡没有被洗稿搬运，不就在用这个主题的[词元计数器](https://hi.tokenisite.top/)嘛……

## 🏛️ 下课！

其实好几周之前就改好主题了，但是一直偷懒，没有动手写博客。下回见！
